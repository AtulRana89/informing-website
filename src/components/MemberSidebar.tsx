import React, { useEffect } from "react";
import { NavLink, useNavigate } from "react-router-dom";
import { cookieUtils } from "../services";
import { jwtDecode } from "jwt-decode";

interface MemberSidebarProps {
  isOpen: boolean;
  setIsOpen: (open: boolean) => void;
}

const MemberSidebar: React.FC<MemberSidebarProps> = ({ isOpen, setIsOpen }) => {
   const navigate = useNavigate();

  useEffect(() => {
    const token =
      cookieUtils.getCookie("COOKIES_USER_ACCESS_TOKEN") ||
      cookieUtils.getCookie("authToken");

    let decoded: any = {};
    if (token) {
      decoded = jwtDecode(token);
      console.log("Decoded Token:", decoded);
    }
   
    if (decoded?.role != "admin") {
      navigate("/about");
    }
    
  }, []);

  const navigationItems = [
    {
      name: "Dashboard",
      href: "/member/dashboard",
      icon: (
        <svg
          width="16"
          height="15"
          viewBox="0 0 16 15"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M8.10692 2.96736C8.06418 2.92563 8.00733 2.90234 7.94819 2.90234C7.88906 2.90234 7.8322 2.92563 7.78947 2.96736L2.50535 8.11979C2.48291 8.14171 2.46506 8.16804 2.45287 8.19719C2.44068 8.22635 2.43442 8.25773 2.43445 8.28942L2.43359 13.1252C2.43359 13.3738 2.53036 13.6123 2.70261 13.7881C2.87486 13.9639 3.10848 14.0627 3.35207 14.0627H6.11038C6.23217 14.0627 6.34898 14.0133 6.43511 13.9254C6.52123 13.8375 6.56961 13.7182 6.56961 13.5939V9.60954C6.56961 9.54738 6.59381 9.48777 6.63687 9.44381C6.67993 9.39986 6.73834 9.37517 6.79923 9.37517H9.09543C9.15633 9.37517 9.21473 9.39986 9.25779 9.44381C9.30086 9.48777 9.32505 9.54738 9.32505 9.60954V13.5939C9.32505 13.7182 9.37343 13.8375 9.45956 13.9254C9.54568 14.0133 9.66249 14.0627 9.78429 14.0627H12.5414C12.785 14.0627 13.0187 13.9639 13.1909 13.7881C13.3632 13.6123 13.4599 13.3738 13.4599 13.1252V8.28942C13.46 8.25773 13.4537 8.22635 13.4415 8.19719C13.4293 8.16804 13.4115 8.14171 13.389 8.11979L8.10692 2.96736Z"
            fill="currentColor"
          />
          <path
            d="M14.6897 7.15381L12.5427 5.05732V1.87598C12.5427 1.75166 12.4944 1.63243 12.4082 1.54452C12.3221 1.45661 12.2053 1.40723 12.0835 1.40723H10.7058C10.584 1.40723 10.4672 1.45661 10.381 1.54452C10.2949 1.63243 10.2465 1.75166 10.2465 1.87598V2.81348L8.5841 1.19102C8.42853 1.03047 8.19719 0.938477 7.94719 0.938477C7.69805 0.938477 7.46728 1.03047 7.31172 1.19131L1.20671 7.15322C1.02818 7.329 1.00579 7.61816 1.16825 7.80859C1.20904 7.85666 1.25899 7.89575 1.31506 7.92349C1.37113 7.95122 1.43214 7.96703 1.49438 7.96993C1.55662 7.97284 1.61878 7.96278 1.6771 7.94039C1.73541 7.91799 1.78865 7.88371 1.83357 7.83965L7.78933 2.03066C7.83206 1.98894 7.88891 1.96565 7.94805 1.96565C8.00719 1.96565 8.06404 1.98894 8.10677 2.03066L14.0631 7.83965C14.1508 7.92553 14.2684 7.9724 14.3899 7.96999C14.5114 7.96757 14.6271 7.91606 14.7115 7.82676C14.8877 7.64043 14.8731 7.33281 14.6897 7.15381Z"
            fill="currentColor"
          />
        </svg>
      ),
    },
    {
      name: "Your Articles",
      href: "/member/articles",
      icon: (
        <svg
          width="16"
          height="15"
          viewBox="0 0 16 15"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M3.64648 14.5312H2.70898C2.5225 14.5312 2.34366 14.4572 2.2118 14.3253C2.07994 14.1934 2.00586 14.0146 2.00586 13.8281V9.60937C2.00586 9.42289 2.07994 9.24405 2.2118 9.11219C2.34366 8.98033 2.5225 8.90625 2.70898 8.90625H3.64648C3.83296 8.90625 4.01181 8.98033 4.14367 9.11219C4.27553 9.24405 4.34961 9.42289 4.34961 9.60937V13.8281C4.34961 14.0146 4.27553 14.1934 4.14367 14.3253C4.01181 14.4572 3.83296 14.5312 3.64648 14.5312V14.5312Z"
            fill="currentColor"
          />
          <path
            d="M10.209 14.5312H9.27148C9.085 14.5312 8.90616 14.4572 8.7743 14.3253C8.64244 14.1934 8.56836 14.0146 8.56836 13.8281V6.79687C8.56836 6.61039 8.64244 6.43155 8.7743 6.29969C8.90616 6.16783 9.085 6.09375 9.27148 6.09375H10.209C10.3955 6.09375 10.5743 6.16783 10.7062 6.29969C10.838 6.43155 10.9121 6.61039 10.9121 6.79687V13.8281C10.9121 14.0146 10.838 14.1934 10.7062 14.3253C10.5743 14.4572 10.3955 14.5312 10.209 14.5312V14.5312Z"
            fill="currentColor"
          />
          <path
            d="M13.4902 14.5312H12.5527C12.3663 14.5312 12.1874 14.4572 12.0556 14.3253C11.9237 14.1934 11.8496 14.0146 11.8496 13.8281V3.51562C11.8496 3.32914 11.9237 3.1503 12.0556 3.01844C12.1874 2.88658 12.3663 2.8125 12.5527 2.8125H13.4902C13.6767 2.8125 13.8556 2.88658 13.9874 3.01844C14.1193 3.1503 14.1934 3.32914 14.1934 3.51562V13.8281C14.1934 14.0146 14.1193 14.1934 13.9874 14.3253C13.8556 14.4572 13.6767 14.5312 13.4902 14.5312V14.5312Z"
            fill="currentColor"
          />
          <path
            d="M6.92773 14.5312H5.99023C5.80375 14.5312 5.62491 14.4572 5.49305 14.3253C5.36119 14.1934 5.28711 14.0146 5.28711 13.8281V1.17187C5.28711 0.985395 5.36119 0.806552 5.49305 0.674691C5.62491 0.542829 5.80375 0.46875 5.99023 0.46875H6.92773C7.11421 0.46875 7.29306 0.542829 7.42492 0.674691C7.55678 0.806552 7.63086 0.985395 7.63086 1.17187V13.8281C7.63086 14.0146 7.55678 14.1934 7.42492 14.3253C7.29306 14.4572 7.11421 14.5312 6.92773 14.5312V14.5312Z"
            fill="currentColor"
          />
        </svg>
      ),
    },
    {
      name: "Your Reviews",
      href: "/member/reviews",
      icon: (
        <svg
          width="15"
          height="16"
          viewBox="0 0 15 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M4.21875 1.01172H6.91406C6.94178 1.01172 6.96844 1.02375 6.98828 1.04492C7.00809 1.06611 7.01953 1.09477 7.01953 1.125V5.5C7.01953 5.90062 7.16884 6.28482 7.43457 6.56836C7.70042 6.85194 8.06118 7.01172 8.4375 7.01172H12.5391C12.5668 7.01172 12.5934 7.02375 12.6133 7.04492C12.6331 7.06611 12.6445 7.09477 12.6445 7.125V13C12.6445 13.5275 12.4481 14.0334 12.0986 14.4062C11.7491 14.779 11.2752 14.9883 10.7812 14.9883H4.21875C3.72483 14.9883 3.25087 14.779 2.90137 14.4062C2.55186 14.0334 2.35547 13.5275 2.35547 13V3C2.35547 2.47245 2.55186 1.96657 2.90137 1.59375C3.25087 1.22095 3.72483 1.01172 4.21875 1.01172ZM5.15625 10.9883C5.02857 10.9883 4.90644 11.0426 4.81641 11.1387C4.72642 11.2347 4.67578 11.3645 4.67578 11.5C4.67578 11.6355 4.72642 11.7653 4.81641 11.8613C4.90644 11.9574 5.02857 12.0117 5.15625 12.0117H9.84375C9.97143 12.0117 10.0936 11.9574 10.1836 11.8613C10.2736 11.7653 10.3242 11.6355 10.3242 11.5C10.3242 11.3645 10.2736 11.2347 10.1836 11.1387C10.0936 11.0426 9.97143 10.9883 9.84375 10.9883H5.15625ZM5.15625 8.48828C5.02857 8.48828 4.90644 8.54263 4.81641 8.63867C4.72642 8.73468 4.67578 8.86454 4.67578 9C4.67578 9.13546 4.72642 9.26532 4.81641 9.36133C4.90644 9.45737 5.02857 9.51172 5.15625 9.51172H9.84375C9.97143 9.51172 10.0936 9.45737 10.1836 9.36133C10.2736 9.26532 10.3242 9.13546 10.3242 9C10.3242 8.86454 10.2736 8.73468 10.1836 8.63867C10.0936 8.54263 9.97143 8.48828 9.84375 8.48828H5.15625Z"
            fill="currentColor"
            stroke="currentColor"
            strokeWidth="0.0234375"
          />
          <path
            d="M8.03613 1.39551C8.04505 1.39739 8.05394 1.40217 8.06055 1.40918L12.2734 5.90332C12.2798 5.91024 12.2843 5.91902 12.2861 5.92871C12.288 5.93868 12.2868 5.94964 12.2832 5.95898C12.2796 5.96807 12.274 5.97602 12.2666 5.98145C12.2589 5.98693 12.2493 5.99019 12.2402 5.99023H8.4375C8.31654 5.99023 8.20003 5.93818 8.11426 5.84668C8.02878 5.75528 7.98055 5.63137 7.98047 5.50195V1.44531C7.98051 1.43528 7.98317 1.42525 7.98828 1.41699C7.99353 1.40866 8.00131 1.40217 8.00977 1.39844C8.01817 1.39473 8.02727 1.39367 8.03613 1.39551Z"
            fill="currentColor"
            stroke="currentColor"
            strokeWidth="0.0234375"
          />
        </svg>
      ),
    },
    {
      name: "Notifications",
      href: "/member/notifications",
      icon: (
        <svg
          width="15"
          height="14"
          viewBox="0 0 15 14"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M7.5 0C3.35938 0 0 3.13542 0 7C0 10.8646 3.35938 14 7.5 14C11.6406 14 15 10.8646 15 7C15 3.13542 11.6406 0 7.5 0ZM7.26562 11.0833C7.11111 11.0833 6.96006 11.0406 6.83159 10.9604C6.70311 10.8803 6.60298 10.7664 6.54384 10.6332C6.48471 10.5 6.46924 10.3534 6.49939 10.2119C6.52953 10.0705 6.60394 9.94054 6.7132 9.83857C6.82246 9.73659 6.96166 9.66715 7.11321 9.63901C7.26476 9.61088 7.42184 9.62531 7.5646 9.6805C7.70735 9.73569 7.82937 9.82915 7.91521 9.94906C8.00106 10.069 8.04688 10.21 8.04688 10.3542C8.04688 10.5476 7.96457 10.733 7.81805 10.8698C7.67154 11.0065 7.47283 11.0833 7.26562 11.0833V11.0833ZM8.57187 7.36458C7.93867 7.76125 7.85156 8.12474 7.85156 8.45833C7.85156 8.5937 7.79395 8.72353 7.69139 8.81925C7.58883 8.91497 7.44973 8.96875 7.30469 8.96875C7.15965 8.96875 7.02055 8.91497 6.91799 8.81925C6.81543 8.72353 6.75781 8.5937 6.75781 8.45833C6.75781 7.65953 7.15156 7.02443 7.96172 6.51656C8.71484 6.04479 9.14062 5.74583 9.14062 5.08849C9.14062 4.64151 8.86719 4.30208 8.30117 4.05089C8.16797 3.99182 7.87149 3.93422 7.50664 3.93823C7.04883 3.9437 6.69336 4.04578 6.41953 4.25141C5.90312 4.63932 5.85938 5.06151 5.85938 5.06771C5.85591 5.13474 5.83834 5.20047 5.80766 5.26116C5.77697 5.32185 5.73378 5.37631 5.68055 5.42142C5.62732 5.46653 5.56509 5.50141 5.49742 5.52408C5.42974 5.54674 5.35795 5.55675 5.28613 5.55352C5.21432 5.55028 5.14388 5.53388 5.07886 5.50524C5.01383 5.47661 4.95549 5.4363 4.90716 5.38662C4.85882 5.33693 4.82145 5.27885 4.79716 5.21569C4.77288 5.15253 4.76216 5.08552 4.76562 5.01849C4.76992 4.9299 4.83594 4.13182 5.7332 3.45807C6.19844 3.1088 6.79023 2.92724 7.49102 2.91922C7.98711 2.91375 8.45312 2.99214 8.76914 3.13141C9.71484 3.54885 10.2344 4.24484 10.2344 5.08849C10.2344 6.32187 9.35117 6.87568 8.57187 7.36458Z"
            fill="currentColor"
          />
        </svg>
      ),
    },
    {
      name: "Peer Directory",
      href: "/member/peer-directory",
      icon: (
        <svg
          width="16"
          height="15"
          viewBox="0 0 16 15"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M10.3449 1.89199C9.77483 1.27646 8.97854 0.9375 8.09964 0.9375C7.21604 0.9375 6.41712 1.27441 5.84964 1.88613C5.276 2.50459 4.99651 3.34512 5.06214 4.25273C5.19222 6.04336 6.55481 7.5 8.09964 7.5C9.64446 7.5 11.0047 6.04365 11.1368 4.25332C11.2033 3.35391 10.9221 2.51514 10.3449 1.89199Z"
            fill="currentColor"
          />
          <path
            d="M13.256 14.0615H2.94353C2.80855 14.0633 2.67487 14.0349 2.55223 13.9785C2.42958 13.9221 2.32106 13.8391 2.23454 13.7354C2.04411 13.5078 1.96736 13.197 2.02419 12.8826C2.27146 11.5109 3.04314 10.3587 4.25603 9.5498C5.33356 8.83174 6.6985 8.43652 8.09977 8.43652C9.50104 8.43652 10.866 8.83203 11.9435 9.5498C13.1564 10.3584 13.9281 11.5106 14.1754 12.8823C14.2322 13.1967 14.1554 13.5075 13.965 13.7352C13.8785 13.8388 13.77 13.9219 13.6474 13.9784C13.5247 14.0348 13.391 14.0632 13.256 14.0615Z"
            fill="currentColor"
          />
        </svg>
      ),
    },
    {
      name: "Conferences",
      href: "/member/conferences",
      icon: (
        <svg
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0ZM8 14.5C4.41015 14.5 1.5 11.5899 1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8C14.5 11.5899 11.5899 14.5 8 14.5Z"
            fill="currentColor"
          />
          <path
            d="M8 1.5C4.41015 1.5 1.5 4.41015 1.5 8H14.5C14.5 4.41015 11.5899 1.5 8 1.5Z"
            fill="currentColor"
          />
          <path
            d="M8 14.5C11.5899 14.5 14.5 11.5899 14.5 8H1.5C1.5 11.5899 4.41015 14.5 8 14.5Z"
            fill="currentColor"
          />
          <path d="M2.5 4.5H13.5" stroke="currentColor" strokeWidth="0.5" />
          <path d="M2.5 11.5H13.5" stroke="currentColor" strokeWidth="0.5" />
        </svg>
      ),
    },
    {
      name: "Membership Options",
      href: "/member/membership-options",
      icon: (
        <svg
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0ZM8 14C4.68629 14 2 11.3137 2 8C2 4.68629 4.68629 2 8 2C11.3137 2 14 4.68629 14 8C14 11.3137 11.3137 14 8 14Z"
            fill="currentColor"
          />
          <path
            d="M8 4C5.79086 4 4 5.79086 4 8C4 10.2091 5.79086 12 8 12C10.2091 12 12 10.2091 12 8C12 5.79086 10.2091 4 8 4ZM8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5Z"
            fill="currentColor"
          />
          <circle cx="8" cy="8" r="1.5" fill="currentColor" />
        </svg>
      ),
    },
  ];

  return (
    <>
      {/* Mobile overlay */}
      {isOpen && (
        <div
          className="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden"
          onClick={() => setIsOpen(false)}
        />
      )}

      {/* Sidebar */}
      <aside
        className={`min-h-[90vh] fixed inset-y-0 left-0 z-50 w-96 bg-[#295F9A] transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 lg:w-96 lg:rounded-xl ${
          isOpen ? "translate-x-0" : "-translate-x-full"
        }`}
      >
        <div className="flex flex-col h-full">
          {/* Sidebar content */}
          <nav className="flex-1 px-4 py-6 space-y-2">
            {navigationItems.map((item) => (
              <NavLink
                key={item.name}
                to={item.href}
                className={({ isActive }) =>
                  `flex items-center px-4 py-3 text-sm font-medium transition-colors rounded-xl ${
                    isActive
                      ? "bg-white text-[#295F9A]"
                      : "text-white bg-white bg-opacity-5 hover:bg-white hover:bg-opacity-10"
                  }`
                }
                onClick={() => setIsOpen(false)}
              >
                {({ isActive }) => (
                  <>
                    <span
                      className={`mr-3 w-8 h-8 rounded-[12px] flex items-center justify-center ${
                        isActive ? "bg-[#295F9A]" : "bg-white"
                      }`}
                    >
                      <div
                        className={isActive ? "text-white" : "text-[#295F9A]"}
                      >
                        {item.icon}
                      </div>
                    </span>
                    {item.name}
                  </>
                )}
              </NavLink>
            ))}
          </nav>

          {/* Sidebar footer */}
          <div className="px-4 py-4">
            <div className="text-white text-xs space-y-2">
              <div className="flex items-center space-x-4 text-xs">
                <a href="#" className="hover:underline">
                  ISI Website
                </a>
                <a href="#" className="hover:underline">
                  Privacy Policy
                </a>
                <a href="#" className="hover:underline">
                  Ethics Policy
                </a>
                <a href="#" className="hover:underline">
                  Legal Disclaimer
                </a>
              </div>
            </div>
          </div>
        </div>
      </aside>
    </>
  );
};

export default MemberSidebar;
